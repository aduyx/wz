<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>货代实用工具 - AI智货代</title>
  
  <!-- SEO 元数据 -->
  <meta name="description" content="AI智货代 - 专业的货代实用工具平台，提供海运费查询、船期查询、货代服务商推荐等一站式货代服务。助力货代行业数字化转型。">
  <meta name="keywords" content="货代工具,海运费查询,船期查询,货代服务,AI智货代,国际物流,供应链管理,货代平台">
  <meta name="author" content="AI智货代">
  <meta name="robots" content="index, follow">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <!-- 全局样式 -->
  <link rel="stylesheet" href="/assets/css/global.css">
  
  <!-- 自定义配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#165DFF',
            secondary: '#0E2E88',
            accent: '#FF7D00',
            neutral: '#F5F7FA',
            dark: '#1D2129',
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .text-shadow {
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .transition-custom {
        transition: all 0.3s ease;
      }
      .card-hover {
        @apply hover:shadow-lg hover:-translate-y-1 transition-custom;
      }
      .custom-gradient {
        background: linear-gradient(to right, 
          #3b82f6 0%, 
          #3b82f6 61.8%, 
          #14b8a6 80.9%, 
          #06b6d4 100%);
      }
      .text-gradient {
        background: linear-gradient(45deg, #fbbf24, #f59e0b, #d97706, #92400e);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .h2-gradient {
        background: linear-gradient(135deg, #165DFF 0%, #0E2E88 30%, #FF7D00 70%, #f59e0b 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        background-size: 200% 200%;
        animation: gradientShift 3s ease-in-out infinite;
      }
      @keyframes gradientShift {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
      }
      
      /* 统一按钮样式 */
      .btn-primary {
        @apply bg-primary text-white font-medium py-3 px-6 rounded-lg hover:bg-primary/90 transition-all duration-300 ease-in-out transform hover:scale-105 shadow-md hover:shadow-lg;
      }
      
      .btn-secondary {
        @apply bg-gray-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-700 transition-all duration-300 ease-in-out transform hover:scale-105 shadow-md hover:shadow-lg;
      }
      
      .btn-accent {
        @apply bg-yellow-500 text-black font-medium py-2 px-4 rounded-lg hover:bg-yellow-400 transition-all duration-300 ease-in-out transform hover:scale-105 shadow-md hover:shadow-lg;
      }
      
      /* 强制首页使用浅色背景 */
      body {
        background-color: #f9fafb !important;
      }
      
      /* 船东卡片样式 */
      .card--shipowner {
        background-color: #ffffff !important;
        color: #1f2937 !important;
      }
      
      .card--shipowner .card__title {
        color: #374151 !important;
      }
      
      /* 响应式设计优化 */
      @media (max-width: 767px) {
        .hero {
          @apply py-6 px-3;
        }
        .hero__title {
          @apply text-2xl leading-tight;
        }
        .hero__subtitle {
          @apply text-base;
        }
        .container {
          @apply px-3;
        }
        .tracking-section__form {
          @apply flex-col space-y-3;
        }
        .form__select {
          @apply w-full;
        }
        .news-section__grid {
          @apply grid-cols-1 gap-4;
        }
        .shipowner-section__grid {
          @apply grid-cols-2 gap-3;
        }
      }
      
      @media (max-width: 480px) {
        .hero {
          @apply py-4 px-2;
        }
        .hero__title {
          @apply text-xl;
        }
        .container {
          @apply px-2;
        }
        .shipowner-section__grid {
          @apply grid-cols-1 gap-2;
        }
      }
      
      /* 懒加载动画 */
      .lazy-load {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.6s ease, transform 0.6s ease;
      }
      .lazy-load.loaded {
        opacity: 1;
        transform: translateY(0);
      }
      
      /* 改进的船东卡片样式 */
      .card--shipowner {
        @apply transition-all duration-300 ease-in-out;
      }
      .card--shipowner:hover {
        @apply border-primary/30 shadow-lg transform scale-105;
      }
    }
  </style>
  <!-- 全局JavaScript -->
  <script src="/assets/js/global.js?v=20251114"></script>
</head>
<body class="bg-gray-50 font-sans text-dark">
  <!-- 页眉容器 -->
  <div id="header-container"></div>

  <main id="main">
    <!-- 全宽横幅 -->
    <section class="hero custom-gradient text-white py-8" id="home-hero">
      <div class="container mx-auto px-4 text-left">
        <h1 class="hero__title text-[clamp(2rem,5vw,3.5rem)] font-bold mb-4 text-shadow" id="home-hero-title">
          AI 智货代 | 改变货代的功效
        </h1>
        <p class="hero__subtitle text-[clamp(1rem,2vw,1.25rem)] max-w-3xl opacity-90" id="home-hero-subtitle">
          用人工智能重构国际货运代理的工作逻辑，让货代从业者从繁琐操作中释放精力，实现"快人一步"的高效运转。
        </p>
        <div class="mt-4 flex flex-wrap gap-3">
          <a href="pages/user/upgrade.html" class="btn-primary inline-flex items-center" id="home-hero-btn1">
            <i class="fas fa-crown mr-2"></i> <span>会员升级/开通</span>
          </a>
          <a href="pages/user/membership.html" class="btn-secondary inline-flex items-center" id="home-hero-btn2">
            <i class="fas fa-shield-alt mr-2"></i> <span>查看会员权益</span>
          </a>
        </div>
      </div>
    </section>

    <!-- 主内容容器 -->
    <section class="container mx-auto px-4 py-8">
      <div class="flex flex-col md:flex-row gap-6 md:gap-8">
        <!-- 左侧容器 - 占3/4宽度 -->
        <div class="w-full md:w-3/4 space-y-6">
          <!-- 集装箱追踪查询 -->
          <div class="tracking-section bg-white rounded-lg shadow-sm p-6 border border-yellow-500 lazy-load">
            <h2 class="tracking-section__title text-2xl font-bold mb-4 h2-gradient">集装箱追踪查询</h2>
            <div class="tracking-section__form flex flex-col sm:flex-row gap-3">
              <input type="text" placeholder="请输入提单号或箱号" class="form__input flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary text-sm">
              <select class="form__select w-full sm:w-48 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary text-sm">
                <option value="all">所有船东</option>
                <option value="msc">地中海航运(MSC)</option>
                <option value="maersk">马士基(Maersk)</option>
                <option value="cma">达飞轮船(CMA CGM)</option>
                <option value="cosco">中远海运(COSCO Shipping)</option>
                <option value="hapag">赫伯罗特(Hapag-Lloyd)</option>
                <option value="one">海洋网联(ONE)</option>
                <option value="evergreen">长荣海运(Evergreen)</option>
                <option value="hmm">现代商船(HMM)</option>
                <option value="zim">以星航运(ZIM)</option>
                <option value="yangming">阳明海运(Yang Ming)</option>
                <option value="oocl">东方海外(OOCL)</option>
                <option value="pil">太平船务(PIL)</option>
                <option value="wanhai">万海航运(Wan Hai)</option>
                <option value="kmtc">高丽海运(KMTC)</option>
                <option value="sitc">海丰国际(SITC)</option>
                <option value="tslines">德翔海运(TS Lines)</option>
                <option value="rcl">宏海船务(RCL)</option>
                <option value="smline">长锦商船(SM Line)</option>
                <option value="ckline">天敬海运(CK Line)</option>
                <option value="namsung">南星船务(NAMSUNG)</option>
              </select>
              <button class="btn-primary w-full sm:w-auto px-4 py-2 flex items-center justify-center whitespace-nowrap text-sm">
                <i class="fas fa-search mr-1"></i>
                <span>查询</span>
              </button>
            </div>
            <div class="tracking-section__help mt-4 text-center">
              <p class="text-gray-600">没有找到所需要的船东？<a href="#" class="text-primary hover:text-primary/80 font-medium transition-all duration-300 ease-in-out hover:underline">申请加入船东</a></p>
            </div>
          </div>

          <!-- 行业快讯 -->
          <div class="schedules-section bg-white rounded-lg shadow-sm p-6 border border-yellow-500 mt-6">
            <h2 class="text-2xl font-bold mb-4 h2-gradient">船期查询</h2>
            <div class="flex flex-col sm:flex-row gap-3">
              <input id="schedule-dest" type="text" placeholder="请输入目的港（支持中文/英文/代码模糊匹配）" list="schedule-dest-list" class="form__input w-56 md:w-64 h-10 px-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary text-sm">
              <datalist id="schedule-dest-list"></datalist>
              <select id="schedule-carrier" class="w-full sm:w-48 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary text-sm"></select>
              <button id="schedule-search" class="btn-primary w-full sm:w-auto px-4 py-2 flex items-center justify-center whitespace-nowrap text-sm">
                <i class="fas fa-calendar-alt mr-1"></i>
                <span>查询船期</span>
              </button>
            </div>
          </div>
          <script>
            (function(){
              try {
                var carriers = [
                  { code: 'msc', name: '地中海航运(MSC)' },
                  { code: 'maersk', name: '马士基(Maersk)' },
                  { code: 'cma', name: '达飞轮船(CMA CGM)' },
                  { code: 'cosco', name: '中远海运(COSCO Shipping)' },
                  { code: 'hapag', name: '赫伯罗特(Hapag-Lloyd)' },
                  { code: 'one', name: '海洋网联(ONE)' },
                  { code: 'evergreen', name: '长荣海运(Evergreen)' },
                  { code: 'hmm', name: '现代商船(HMM)' },
                  { code: 'zim', name: '以星航运(ZIM)' },
                  { code: 'yangming', name: '阳明海运(Yang Ming)' },
                  { code: 'oocl', name: '东方海外(OOCL)' },
                  { code: 'pil', name: '太平船务(PIL)' },
                  { code: 'wanhai', name: '万海航运(Wan Hai)' },
                  { code: 'kmtc', name: '高丽海运(KMTC)' },
                  { code: 'sitc', name: '海丰国际(SITC)' },
                  { code: 'tslines', name: '德翔海运(TS Lines)' },
                  { code: 'rcl', name: '宏海船务(RCL)' },
                  { code: 'smline', name: '长锦商船(SM Line)' },
                  { code: 'ckline', name: '天敬海运(CK Line)' },
                  { code: 'namsung', name: '南星船务(NAMSUNG)' }
                ];
                var scheduleLinks = {};
                try { scheduleLinks = JSON.parse(localStorage.getItem('shipowner_schedule_links')||'{}'); } catch(e) {}
                try { if (window.APP_API && window.APP_API.base) { window.APP_API.get('shipowner_schedule_links').then(function(obj){ if (obj) scheduleLinks = obj; }); } } catch(e){}
                function setOptions(sel, list){ sel.innerHTML = ''; list.forEach(function(it){ var opt = document.createElement('option'); opt.value = it.code; opt.textContent = it.name; sel.appendChild(opt); }); }
                var carrierSel = document.getElementById('schedule-carrier');
                if (carrierSel) setOptions(carrierSel, carriers);
                var destListEl = document.getElementById('schedule-dest-list');
                var destRaw = [];
                function loadDestinations(){
                  return fetch('/data/ports/destination_ports_sample.csv?v=' + Date.now(), { cache: 'no-store' })
                    .then(function(r){ return r.text(); })
                    .then(function(txt){
                      var lines = txt.split(/\r?\n/).filter(function(s){ return s.trim().length > 0; });
                      lines.shift();
                      destRaw = lines.map(function(line){ var cols = line.split(','); return { zh: cols[0]||'', en: cols[1]||'', code: cols[2]||'', alias: (cols[3]||'') }; });
                      refreshDestList(destRaw);
                    }).catch(function(){
                      var fallback = [ { zh: '洛杉矶', en: 'Los Angeles', code: 'USLAX', alias: 'los angeles,lax' }, { zh: '长滩', en: 'Long Beach', code: 'USLGB', alias: 'long beach,lgb' } ];
                      destRaw = fallback; refreshDestList(destRaw);
                    });
                }
                function refreshDestList(list){ if (!destListEl) return; destListEl.innerHTML = ''; list.forEach(function(p){ var opt = document.createElement('option'); opt.value = (p.zh||'') + (p.en?(' ('+p.en+')'):'') + (p.code?(' ['+p.code+']'):''); destListEl.appendChild(opt); }); }
                function matches(item, q){ if (!q) return true; var s = String(q).trim().toLowerCase(); if (!s) return true; var alias = (item.alias||'').toLowerCase(); return (item.zh||'').toLowerCase().indexOf(s)>=0 || (item.en||'').toLowerCase().indexOf(s)>=0 || alias.indexOf(s)>=0 || (item.code||'').toLowerCase().indexOf(s)>=0; }
                var inputEl = document.getElementById('schedule-dest');
                if (inputEl) { inputEl.addEventListener('input', function(){ try { var q = inputEl.value||''; var filtered = destRaw.filter(function(p){ return matches(p, q); }); refreshDestList(filtered); } catch(e){} }); }
                loadDestinations();
                var btn = document.getElementById('schedule-search');
                if (btn) { btn.addEventListener('click', function(){ try { var carrier = carrierSel?carrierSel.value:''; var link = scheduleLinks[carrier]||''; if (!link) { alert('尚未配置该船东的船期链接'); return; } var inputVal = inputEl ? inputEl.value : ''; var portCode = ''; var m = inputVal.match(/\[(.*?)\]/); if (m && m[1]) { portCode = m[1].trim(); } if (!portCode) { var filtered = destRaw.filter(function(p){ return matches(p, inputVal); }); if (filtered.length>0) { portCode = filtered[0].code||''; } } if (portCode && link.indexOf('{port}')>=0) { link = link.replace('{port}', encodeURIComponent(portCode)); } window.location.href = link; } catch(e){} }); }
              } catch(e) {}
            })();
          </script>
          <div class="news-section bg-white rounded-lg shadow-sm p-6 border border-green-500 lazy-load">
            <div class="news-section__header flex items-center justify-between mb-4">
              <h2 class="news-section__title text-2xl font-bold h2-gradient">行业快讯</h2>
              <a href="news.html" class="text-primary hover:text-primary/80 font-medium transition-all duration-300 ease-in-out hover:underline flex items-center">
                更多资讯 <i class="fas fa-angle-right ml-1"></i>
              </a>
            </div>
            <div class="news-section__grid grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3" id="home-news-grid">
              <!-- 文章卡片 1 -->
              <a href="news.html" class="card card--news bg-white border border-blue-300 rounded-lg overflow-hidden shadow-sm card-hover block">
                <div class="card__image h-16 bg-gradient-to-r from-blue-400 to-blue-600 flex items-center justify-center">
                  <i class="fas fa-ship text-white text-2xl"></i>
                </div>
                <div class="card__content p-3">
                  <h3 class="card__title font-bold text-sm mb-1 line-clamp-2">全球供应链恢复，国际海运价格趋于平稳</h3>
                  <p class="card__description text-gray-600 text-xs line-clamp-2">随着全球影响到货代的功效，国际供应链逐步恢复正常，海运价格也开始趋于平稳...</p>
                </div>
              </a>
              
              <!-- 文章卡片 2 -->
              <a href="news.html" class="card card--news bg-white border border-green-300 rounded-lg overflow-hidden shadow-sm card-hover block">
                <div class="card__image h-16 bg-gradient-to-r from-green-400 to-green-600 flex items-center justify-center">
                  <i class="fas fa-robot text-white text-2xl"></i>
                </div>
                <div class="card__content p-3">
                  <h3 class="card__title font-bold text-sm mb-1 line-clamp-2">人工智能如何改变货代行业的未来</h3>
                  <p class="card__description text-gray-600 text-xs line-clamp-2">人工智能技术正在各个行业掀起变革，货代行业也不例外。从智能报价到自动单证处理...</p>
                </div>
              </a>
              
              <!-- 文章卡片 3 -->
              <a href="news.html" class="card card--news bg-white border border-orange-300 rounded-lg overflow-hidden shadow-sm card-hover block">
                <div class="card__image h-16 bg-gradient-to-r from-orange-400 to-orange-600 flex items-center justify-center">
                  <i class="fas fa-globe-asia text-white text-2xl"></i>
                </div>
                <div class="card__content p-3">
                  <h3 class="card__title font-bold text-sm mb-1 line-clamp-2">东南亚航线新机遇：RCEP协定实施一周年</h3>
                  <p class="card__description text-gray-600 text-xs line-clamp-2">RCEP协定实施一周年，为东南亚航线带来新的发展机遇。区域内贸易便利化程度提高...</p>
                </div>
              </a>
              
              <!-- 文章卡片 4 -->
              <a href="news.html" class="card card--news bg-white border border-purple-300 rounded-lg overflow-hidden shadow-sm card-hover block">
                <div class="card__image h-16 bg-gradient-to-r from-purple-400 to-purple-600 flex items-center justify-center">
                  <i class="fas fa-digital-tachograph text-white text-2xl"></i>
                </div>
                <div class="card__content p-3">
                  <h3 class="card__title font-bold text-sm mb-1 line-clamp-2">数字化转型：货代企业的必经之路</h3>
                  <p class="card__description text-gray-600 text-xs line-clamp-2">在数字化浪潮下，货代企业面临前所未有的挑战和机遇。如何利用数字技术提升服务质量...</p>
                </div>
              </a>
            </div>
          </div>

          <!-- 船东列表 -->
          <div class="shipowners-section bg-white rounded-lg shadow-sm p-6 border border-orange-500 lazy-load">
            <div class="shipowners-section__header mb-4">
              <h2 class="shipowners-section__title text-2xl font-bold h2-gradient">船东列表</h2>
            </div>
            <div class="shipowners-section__grid grid grid-cols-5 gap-4">
              <!-- 第一行 -->
              <div class="card card--shipowner text-center card-hover border border-red-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/1msc.webp?v=20251109" alt="地中海航运" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-red-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">MSC</div>
                </div>
                <p class="card__title text-xs font-medium">地中海航运</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-blue-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/2msk.webp?v=20251109" alt="马士基" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-blue-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">Maersk</div>
                </div>
                <p class="card__title text-xs font-medium">马士基</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-green-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/3cma.webp?v=20251109" alt="达飞轮船" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-green-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">CMA</div>
                </div>
                <p class="card__title text-xs font-medium">达飞轮船</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-yellow-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/4cosco.webp?v=20251109" alt="中远海运" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-yellow-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">COSCO</div>
                </div>
                <p class="card__title text-xs font-medium">中远海运</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-purple-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/5hpl.webp?v=20251109" alt="赫伯罗特" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-purple-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">HPL</div>
                </div>
                <p class="card__title text-xs font-medium">赫伯罗特</p>
              </div>
              
              <!-- 第二行 -->
              <div class="card card--shipowner text-center card-hover border border-pink-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/6one.webp?v=20251109" alt="海洋网联" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-pink-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">ONE</div>
                </div>
                <p class="card__title text-xs font-medium">海洋网联</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-indigo-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/7emc.webp?v=20251109" alt="长荣海运" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-indigo-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">EMC</div>
                </div>
                <p class="card__title text-xs font-medium">长荣海运</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-teal-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/8hmm.webp?v=20251109" alt="现代商船" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-teal-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">HMM</div>
                </div>
                <p class="card__title text-xs font-medium">现代商船</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-cyan-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/9zim.webp?v=20251109" alt="以星航运" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-cyan-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">ZIM</div>
                </div>
                <p class="card__title text-xs font-medium">以星航运</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-lime-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/10ym.webp?v=20251109" alt="阳明海运" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-lime-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">YM</div>
                </div>
                <p class="card__title text-xs font-medium">阳明海运</p>
              </div>
              
              <!-- 第三行 -->
              <div class="card card--shipowner text-center card-hover border border-emerald-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/11oocl.webp?v=20251109" alt="东方海外" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-emerald-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">OOCL</div>
                </div>
                <p class="card__title text-xs font-medium">东方海外</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-amber-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/12pil.webp?v=20251109" alt="太平船务" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-amber-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">PIL</div>
                </div>
                <p class="card__title text-xs font-medium">太平船务</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-rose-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/13wanhai.webp?v=20251109" alt="万海航运" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-rose-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">万海</div>
                </div>
                <p class="card__title text-xs font-medium">万海航运</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-violet-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/14kmtc.webp?v=20251109" alt="高丽海运" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-violet-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">高丽</div>
                </div>
                <p class="card__title text-xs font-medium">高丽海运</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-sky-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/15sitc.webp?v=20251109" alt="海丰国际" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-sky-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">海丰</div>
                </div>
                <p class="card__title text-xs font-medium">海丰国际</p>
              </div>
              
              <!-- 第四行 -->
              <div class="card card--shipowner text-center card-hover border border-orange-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/16tsl.webp?v=20251109" alt="德翔海运" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-orange-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">TSL</div>
                </div>
                <p class="card__title text-xs font-medium">德翔海运</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-slate-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/17rcl.webp?v=20251109" alt="宏海船务" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-slate-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">RCL</div>
                </div>
                <p class="card__title text-xs font-medium">宏海船务</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-stone-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/18smline.webp?v=20251109" alt="长锦商船" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-stone-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">长锦</div>
                </div>
                <p class="card__title text-xs font-medium">长锦商船</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-neutral-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/19ckline.webp?v=20251109" alt="天敬海运" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-neutral-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">天敬</div>
                </div>
                <p class="card__title text-xs font-medium">天敬海运</p>
              </div>
              
              <div class="card card--shipowner text-center card-hover border border-zinc-300 rounded-lg p-2">
                <div class="card__image h-16 flex items-center justify-center mb-1">
                  <img src="/assets/images/20namsung.webp?v=20251109" alt="南星船务" class="h-12 w-auto object-contain" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.classList.remove('hidden-element');">
                  <div class="bg-zinc-500 text-white px-2 py-1 rounded text-xs font-bold hidden-element">南星</div>
                </div>
                <p class="card__title text-xs font-medium">南星船务</p>
              </div>
            </div>
          </div>
        </div>

          

        <!-- 右侧边栏 - 占1/4宽度 -->
        <div class="w-full md:w-1/4 space-y-6">
          <!-- 运价查询板块 -->
          <div class="sidebar__card bg-white rounded-lg shadow-sm p-4 border border-red-500 lazy-load">
            <h3 class="sidebar__title text-lg font-bold mb-3 h2-gradient">运价查询</h3>
            <!-- 右到左滚动文字 -->
            <div class="mb-3 overflow-hidden relative h-8">
              <div class="marquee-rtl whitespace-nowrap absolute right-0">
                <span id="freight-marquee-text" class="text-sm text-gray-700">热门航线更新：亚洲→北美、欧洲→东南亚、跨太平洋多港直航，实时行情波动，立即查询最新运价！</span>
              </div>
            </div>
            <!-- 查询表单 -->
            <form class="space-y-3" action="pages/pricing/index.html" method="get">
              <div class="p-3 bg-yellow-50 border border-yellow-200 rounded">
                <div class="text-sm font-bold text-yellow-800">最新报价</div>
                <div class="text-sm text-yellow-900 mt-1">点击下方来查询并直接生成报价单发给客户</div>
              </div>
              <button type="submit" class="w-full bg-blue-600 text-white rounded py-2 text-sm hover:bg-blue-700 transition-colors">运价查询</button>
            </form>
          </div>
          <!-- 获客中心（插入到运价查询下、实用工具上方） -->
          <div id="home-leads-card" class="sidebar__card bg-white rounded-lg shadow-sm p-4 border border-violet-500 lazy-load">
            <h3 id="home-leads-title" class="sidebar__title text-lg font-bold mb-3 h2-gradient">获客中心</h3>
            <div class="grid grid-cols-2 gap-2">
              <a id="home-leads-item-0" href="pages/leads/index.html?type=本地货代" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors text-center">
                <div class="text-sm font-medium">国内同行</div>
                <div class="text-xs text-gray-600">对接本地/全国货代伙伴</div>
              </a>
              <a id="home-leads-item-1" href="pages/leads/index.html?type=海外代理" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors text-center">
                <div class="text-sm font-medium">海外代理</div>
                <div class="text-xs text-gray-600">拓展海外船东与代理网</div>
              </a>
              <a id="home-leads-item-2" href="pages/leads/index.html?type=国内工厂" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors text-center">
                <div class="text-sm font-medium">国内工厂</div>
                <div class="text-xs text-gray-600">链接制造端直客需求</div>
              </a>
              <a id="home-leads-item-3" href="pages/leads/index.html?type=海外买家" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors text-center">
                <div class="text-sm font-medium">海外买家</div>
                <div class="text-xs text-gray-600">对接进口买家与渠道</div>
              </a>
            </div>
          </div>
          <!-- 快速工具 -->
          <div id="home-tools-card" class="sidebar__card bg-white rounded-lg shadow-sm p-4 border border-blue-500 lazy-load">
            <div class="flex items-center justify-between mb-3">
              <h3 id="home-tools-title" class="sidebar__title text-lg font-bold h2-gradient">实用工具</h3>
              <a id="home-tools-enter" href="pages/tools/index.html" class="inline-flex items-center px-3 py-1 text-xs rounded bg-blue-600 text-white hover:bg-blue-700">
                <i class="fas fa-toolbox mr-1"></i><span class="enter-text">进入实用工具</span>
              </a>
            </div>
            <div class="grid grid-cols-2 gap-2">
              <a href="pages/tools/quote-calculator.html" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors flex items-center">
                <i class="fas fa-calculator text-primary mr-2"></i>
                <span class="text-sm">运费计算器</span>
              </a>
              <a href="pages/schedules/index.html" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors flex items-center">
                <i class="fas fa-calendar-alt text-primary mr-2"></i>
                <span class="text-sm">船期查询</span>
              </a>
              <a href="pages/tools/index.html" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors flex items-center">
                <i class="fas fa-exchange-alt text-primary mr-2"></i>
                <span class="text-sm">汇率查询</span>
              </a>
              <a href="pages/tools/freight-query.html" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors flex items-center">
                <i class="fas fa-anchor text-primary mr-2"></i>
                <span class="text-sm">运价查询</span>
              </a>
            </div>
          </div>

          <!-- 热门服务 -->
          <div id="home-mall-card" class="sidebar__card bg-white rounded-lg shadow-sm p-4 border border-green-500 lazy-load">
            <div class="flex items-center justify-between mb-3">
              <h3 id="home-mall-title" class="sidebar__title text-lg font-bold h2-gradient">积分商城</h3>
              <a id="home-mall-enter" href="pages/points-mall/index.html" class="inline-flex items-center px-3 py-1 text-xs rounded bg-green-600 text-white hover:bg-green-700">
                <i class="fas fa-store mr-1"></i><span class="enter-text">进入积分商城</span>
              </a>
            </div>
            <div class="grid grid-cols-2 gap-2">
              <a href="pages/points-mall/index.html" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors">
                <div class="text-sm font-medium">航运礼品</div>
                <div class="text-xs text-gray-600">精选航运主题礼品</div>
              </a>
              <a href="pages/points-mall/index.html" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors">
                <div class="text-sm font-medium">人形玩偶</div>
                <div class="text-xs text-gray-600">可爱船员人形玩偶</div>
              </a>
              <a href="pages/points-mall/index.html" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors">
                <div class="text-sm font-medium">地区特产</div>
                <div class="text-xs text-gray-600">各地港口特色商品</div>
              </a>
              <a href="pages/points-mall/index.html" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors">
                <div class="text-sm font-medium">航运动态</div>
                <div class="text-xs text-gray-600">最新航运资讯</div>
              </a>
            </div>
          </div>

          <!-- 联系我们 -->
          <div id="home-museum-card" class="sidebar__card bg-white rounded-lg shadow-sm p-4 border border-orange-500 lazy-load">
            <div class="flex items-center justify-between mb-3">
              <h3 id="home-museum-title" class="sidebar__title text-lg font-bold h2-gradient">集卡博物馆</h3>
              <a id="home-museum-enter" href="pages/jika-museum/index.html" class="inline-flex items-center px-3 py-1 text-xs rounded bg-orange-500 text-white hover:bg-orange-600">
                <i class="fas fa-truck-moving mr-1"></i><span class="enter-text">进入集卡博物馆</span>
              </a>
            </div>
            <div class="space-y-3">
              <!-- 卡片系列 -->
              <div class="mt-4 pt-3 border-t border-gray-200">
                <h4 class="text-md font-semibold mb-2">卡片系列</h4>
                <div class="grid grid-cols-2 gap-2">
                  <a href="pages/jika-museum/index.html" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors text-center">
                    <div class="text-sm font-medium">航运系列</div>
                  </a>
                  <a href="pages/jika-museum/index.html" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors text-center">
                    <div class="text-sm font-medium">货代系列</div>
                  </a>
                  <a href="pages/jika-museum/index.html" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors text-center">
                    <div class="text-sm font-medium">港口系列</div>
                  </a>
                  <a href="pages/jika-museum/index.html" class="block p-2 rounded-lg hover:bg-gray-50 transition-colors text-center">
                    <div class="text-sm font-medium">集装箱系列</div>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  

  <script>
    

    // 初始化页眉功能
    function initHomepageHeaderFunctions() {
      // 移动端菜单切换
      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');
      
      if (mobileMenuBtn && mobileMenu) {
        mobileMenuBtn.addEventListener('click', function() {
          mobileMenu.classList.toggle('hidden');
        });
      }

      // 定义用户下拉菜单切换函数（增强预览窗口兼容性）
      window.toggleUserDropdown = function() {
        const dropdown = document.getElementById('user-dropdown');
        console.log('Toggle dropdown clicked', dropdown); // 调试信息
        
        if (dropdown) {
          // 强制设置样式以确保在所有环境中都能正常工作
          const isHidden = dropdown.classList.contains('opacity-0') || 
                          dropdown.style.opacity === '0' || 
                          dropdown.style.visibility === 'hidden';
          
          if (isHidden) {
            // 显示下拉菜单 - 使用多种方式确保显示
            dropdown.classList.remove('opacity-0', 'invisible');
            dropdown.classList.add('opacity-100', 'visible');
            dropdown.style.opacity = '1';
            dropdown.style.visibility = 'visible';
            dropdown.style.pointerEvents = 'auto';
            dropdown.style.zIndex = '9999';
            console.log('显示下拉菜单');
          } else {
            // 隐藏下拉菜单
            dropdown.classList.remove('opacity-100', 'visible');
            dropdown.classList.add('opacity-0', 'invisible');
            dropdown.style.opacity = '0';
            dropdown.style.visibility = 'hidden';
            dropdown.style.pointerEvents = 'none';
            console.log('隐藏下拉菜单');
          }
        } else {
          console.error('未找到下拉菜单元素 #user-dropdown');
        }
      };

      // 定义退出登录函数
      window.logout = function() {
        // 清除用户数据
        localStorage.removeItem('userToken');
        localStorage.removeItem('userInfo');
        
        // 更新用户状态显示
        updateMainPageUserStatus();
        
        // 提示用户并跳转到首页
        alert('已成功退出登录');
        window.location.href = '/index.html';
      };

      // 定义用户页面导航函数
      window.navigateToUserPage = function(pageName) {
        // 获取当前页面路径
        const currentPath = window.location.pathname;
        let targetPath;
        
        if (currentPath.includes('/pages/')) {
          // 如果当前在pages目录下，使用相对路径
          if (currentPath.includes('/user/')) {
            // 如果已经在user目录下
            targetPath = pageName;
          } else {
            // 如果在其他pages子目录下
            targetPath = '../user/' + pageName;
          }
        } else {
          // 如果在根目录，使用完整路径
          targetPath = 'pages/user/' + pageName;
        }
        
        console.log('Navigating from', currentPath, 'to', targetPath);
        window.location.href = targetPath;
      };

      // 点击外部关闭下拉菜单
      document.addEventListener('click', function(event) {
        const dropdown = document.getElementById('user-dropdown');
        const userMenuButton = document.querySelector('[onclick="toggleUserDropdown()"]');
        
        if (dropdown && userMenuButton && 
            !dropdown.contains(event.target) && 
            !userMenuButton.contains(event.target)) {
          dropdown.classList.remove('opacity-100', 'visible');
          dropdown.classList.add('opacity-0', 'invisible');
        }
      });

      updateMainPageUserStatus();
    }

    // 初始化页脚功能
    function initFooterFunctions() {
      // 返回顶部功能
      const backToTopBtn = document.getElementById('back-to-top');
      if (backToTopBtn) {
        backToTopBtn.addEventListener('click', function() {
          window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // 滚动显示/隐藏返回顶部按钮
        window.addEventListener('scroll', function() {
          if (window.pageYOffset > 300) {
            backToTopBtn.classList.remove('hidden');
          } else {
            backToTopBtn.classList.add('hidden');
          }
        });
      }

      // 更新统计数据
      updateSiteStats();
    }

    // 更新用户状态
    // 主页专用的用户状态更新函数（避免与header组件冲突）
    function updateMainPageUserStatus() {
      // 检查用户登录状态
      const isLoggedIn = localStorage.getItem('userToken');
      const userInfo = JSON.parse(localStorage.getItem('userInfo') || '{}');
      
      // 获取header组件中的元素
      const authButtons = document.getElementById('auth-buttons');
      const userMenu = document.getElementById('user-menu');
      const userPointsElement = document.getElementById('user-points');
      const userAvatar = document.getElementById('user-avatar');
      const userName = document.getElementById('user-name');
      const pointsValue = document.getElementById('points-value');
      
      if (isLoggedIn && authButtons && userMenu) {
        // 已登录状态 - 隐藏登录按钮，显示用户菜单
        authButtons.classList.add('hidden');
        userMenu.classList.remove('hidden');
        
        // 更新用户信息
        if (userAvatar) {
          userAvatar.src = userInfo.avatar || '/assets/images/logo.webp';
        }
        if (userName) {
          userName.textContent = userInfo.name || userInfo.username || '用户';
        }
        
        // 显示并更新积分
        if (userPointsElement) {
          userPointsElement.classList.remove('hidden');
          userPointsElement.classList.add('flex');
        }
        if (pointsValue) {
          pointsValue.textContent = userInfo.points || 0;
        }
        
        // 检查是否为超级管理员，显示/隐藏后台管理选项
        const adminSection = document.getElementById('admin-section');
        if (adminSection) {
          if (userInfo.level === 'super_admin' || userInfo.role === 'super_admin') {
            adminSection.classList.remove('hidden');
          } else {
            adminSection.classList.add('hidden');
          }
        }
      } else if (authButtons && userMenu) {
        // 未登录状态 - 显示登录按钮，隐藏用户菜单
        authButtons.classList.remove('hidden');
        userMenu.classList.add('hidden');
        
        // 隐藏积分显示
        if (userPointsElement) {
          userPointsElement.classList.add('hidden');
          userPointsElement.classList.remove('flex');
        }
      }
    }



    // 更新网站统计数据
    function updateSiteStats() {
      // 模拟统计数据
      const stats = {
        users: 15420,
        queries: 89650,
        shipowners: 25,
        tools: 12
      };

      // 更新页脚中的统计数据
      const statsElements = {
        'stat-users': stats.users.toLocaleString(),
        'stat-queries': stats.queries.toLocaleString(),
        'stat-shipowners': stats.shipowners,
        'stat-tools': stats.tools
      };

      Object.keys(statsElements).forEach(id => {
        const element = document.getElementById(id);
        if (element) {
          element.textContent = statsElements[id];
        }
      });
    }

    // 用户登出
    function logout() {
      localStorage.removeItem('userToken');
      localStorage.removeItem('userInfo');
      updateMainPageUserStatus();
      alert('已成功退出登录');
    }

    // 应用管理后台的更改
    function applyHomepageChanges() {
      try {
        const savedChanges = localStorage.getItem('homepageChanges');
        if (savedChanges) {
          const changes = JSON.parse(savedChanges);
          
          // 应用横幅标题更改
          if (changes.bannerTitle) {
            const titleElement = document.querySelector('.hero__title');
            if (titleElement) {
              titleElement.textContent = changes.bannerTitle;
            }
          }
          
          // 应用横幅副标题更改
          if (changes.bannerSubtitle) {
            const subtitleElement = document.querySelector('.hero__subtitle');
            if (subtitleElement) {
              subtitleElement.textContent = changes.bannerSubtitle;
            }
          }
          
          // 应用集装箱追踪标题更改
          if (changes.trackingTitle) {
            const trackingElement = document.querySelector('.tracking-section__title');
            if (trackingElement) {
              trackingElement.textContent = changes.trackingTitle;
            }
          }
          
          // 应用集装箱追踪设置更改
          if (changes.trackingSettings) {
            applyTrackingSettings(changes.trackingSettings);
          }
          
          // 应用横幅背景图片或恢复默认渐变
          const heroElement = document.querySelector('.hero');
          if (heroElement) {
            // 检查是否有有效的自定义图片
            const hasValidImage = changes.bannerImage && 
                                  changes.bannerImage !== null &&
                                  changes.bannerImage !== 'data:' && 
                                  changes.bannerImage !== '' && 
                                  !changes.bannerImage.includes('placeholder') &&
                                  !changes.bannerImage.includes('logo.webp');
            
            if (hasValidImage) {
              // 有自定义图片时，移除渐变背景并设置图片
              heroElement.classList.remove('custom-gradient');
              heroElement.style.backgroundImage = `url(${changes.bannerImage})`;
              heroElement.style.backgroundSize = 'cover';
              heroElement.style.backgroundPosition = 'center';
              heroElement.style.backgroundRepeat = 'no-repeat';
            } else {
              // 没有自定义图片时，恢复蓝色渐变背景
              heroElement.style.backgroundImage = '';
              heroElement.style.backgroundSize = '';
              heroElement.style.backgroundPosition = '';
              heroElement.style.backgroundRepeat = '';
              if (!heroElement.classList.contains('custom-gradient')) {
                heroElement.classList.add('custom-gradient');
              }
            }
          }
          
          // 应用主标题字体大小
          if (changes.titleFontSize) {
            const titleElement = document.querySelector('.hero__title');
            if (titleElement) {
              titleElement.style.fontSize = changes.titleFontSize + 'px';
            }
          }
          
          // 应用副标题字体大小
          if (changes.subtitleFontSize) {
            const subtitleElement = document.querySelector('.hero__subtitle');
            if (subtitleElement) {
              subtitleElement.style.fontSize = changes.subtitleFontSize + 'px';
            }
          }
          
          console.log('已应用管理后台的更改');
        }
      } catch (error) {
        console.error('应用首页更改时出错:', error);
      }
    }

    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', function() {
      // 加载全局组件
      loadComponent('header-container', '/components/header.html').then(() => {
        setTimeout(function(){
          var right = document.getElementById('header-right');
          if (right && !document.getElementById('auth-area')) {
            var div = document.createElement('div');
            div.id = 'auth-area';
            div.className = 'flex items-center ml-2';
            right.appendChild(div);
          }
          if (typeof window.initHeaderFunctions === 'function') { window.initHeaderFunctions(); }
          if (typeof initHomepageHeaderFunctions === 'function') { initHomepageHeaderFunctions(); }
        }, 60);
        setTimeout(() => {
          if (typeof updateUserStatus === 'function') {
            updateUserStatus();
          }
        }, 200);
      });
      loadComponent('footer-container', '/components/footer.html');
      
      try {
        var cfgRaw = localStorage.getItem('site_home_config') || '{}';
        var cfg = {};
        try { cfg = JSON.parse(cfgRaw); } catch(_) { cfg = {}; }
        cfg.tools = cfg.tools || {}; cfg.tools.enterLink = '/pages/404.html';
        cfg.mall = cfg.mall || {}; cfg.mall.enterLink = '/pages/404.html';
        cfg.museum = cfg.museum || {}; cfg.museum.enterLink = '/pages/404.html';
        cfg.leads = cfg.leads || {}; cfg.leads.items = Array.isArray(cfg.leads.items) ? cfg.leads.items : [ {}, {}, {}, {} ];
        [0,1,2,3].forEach(function(i){ cfg.leads.items[i] = cfg.leads.items[i] || {}; cfg.leads.items[i].link = '/pages/404.html'; });
        try { localStorage.setItem('site_home_config', JSON.stringify(cfg)); } catch(_e){}
        if (window.APP_API && window.APP_API.set) { try { window.APP_API.set('site_home_config', cfg); } catch(_e){} }
      } catch(_err) {}

      // 初始化懒加载动画
      initLazyLoad();
      
      // 初始化按钮事件
      initButtonEvents();
      
      // 应用管理后台的更改
      setTimeout(applyHomepageChanges, 100);
      // 应用首页模块配置（来自“页面内容管理”）
      setTimeout(applyHomeModuleConfig, 120);
      // 应用与监听：首页横幅与行业快讯
      setTimeout(() => {
        if (typeof syncNewsFromJson === 'function') syncNewsFromJson();
        if (typeof applyHeroConfig === 'function') applyHeroConfig();
        if (typeof applyNewsConfig === 'function') applyNewsConfig();
        if (typeof initHeroListener === 'function') initHeroListener();
        if (typeof initNewsListener === 'function') initNewsListener();
        if (typeof applyFreightMarquee === 'function') applyFreightMarquee();
        if (typeof initFreightMarqueeListener === 'function') initFreightMarqueeListener();
      }, 150);
    });

    // 懒加载动画
    function initLazyLoad() {
      const lazyElements = document.querySelectorAll('.lazy-load');
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('loaded');
            observer.unobserve(entry.target);
          }
        });
      });

      lazyElements.forEach(el => observer.observe(el));
    }

    // 应用首页模块配置（标题、入口按钮、获客中心项等）
    function applyHomeModuleConfig() {
      try {
        function apply(cfg){ if(!cfg) return;

        // 实用工具
        if (cfg.tools) {
          const titleEl = document.getElementById('home-tools-title');
          const enterEl = document.getElementById('home-tools-enter');
          if (titleEl && cfg.tools.title) titleEl.textContent = cfg.tools.title;
          if (enterEl) {
            if (cfg.tools.enterText) {
              const span = enterEl.querySelector('.enter-text');
              if (span) span.textContent = cfg.tools.enterText;
            }
            if (cfg.tools.enterLink) enterEl.href = resolveRootUrl(cfg.tools.enterLink);
          }
        }

        // 积分商城
        if (cfg.mall) {
          const titleEl = document.getElementById('home-mall-title');
          const enterEl = document.getElementById('home-mall-enter');
          if (titleEl && cfg.mall.title) titleEl.textContent = cfg.mall.title;
          if (enterEl) {
            if (cfg.mall.enterText) {
              const span = enterEl.querySelector('.enter-text');
              if (span) span.textContent = cfg.mall.enterText;
            }
            if (cfg.mall.enterLink) enterEl.href = resolveRootUrl(cfg.mall.enterLink);
          }
        }

        // 集卡博物馆
        if (cfg.museum) {
          const titleEl = document.getElementById('home-museum-title');
          const enterEl = document.getElementById('home-museum-enter');
          if (titleEl && cfg.museum.title) titleEl.textContent = cfg.museum.title;
          if (enterEl) {
            if (cfg.museum.enterText) {
              const span = enterEl.querySelector('.enter-text');
              if (span) span.textContent = cfg.museum.enterText;
            }
            if (cfg.museum.enterLink) enterEl.href = resolveRootUrl(cfg.museum.enterLink);
          }
        }

        // 获客中心
        if (cfg.leads) {
          const titleEl = document.getElementById('home-leads-title');
          if (titleEl && cfg.leads.title) titleEl.textContent = cfg.leads.title;
          if (Array.isArray(cfg.leads.items)) {
            cfg.leads.items.forEach((item, idx) => {
              const a = document.getElementById(`home-leads-item-${idx}`);
              if (!a) return;
              const titleDiv = a.querySelector('.text-sm.font-medium');
              const descDiv = a.querySelector('.text-xs.text-gray-600');
              if (titleDiv && item.name) titleDiv.textContent = item.name;
              if (descDiv && item.desc) descDiv.textContent = item.desc;
              if (item.link) a.href = resolveRootUrl(item.link);
            });
          }
        }

        console.log('已应用首页模块配置');
        }
        if (window.APP_API && window.APP_API.base) {
          window.APP_API.get('site_home_config').then(function(cfg){ apply(cfg); });
        } else {
          const cfgStr = localStorage.getItem('site_home_config');
          if (!cfgStr) return;
          const cfg = JSON.parse(cfgStr);
          apply(cfg);
        }
      } catch (e) {
        console.error('应用首页模块配置失败', e);
      }
    }

    // 监听首页模块配置变化，动态应用
    window.addEventListener('storage', function(e) {
      if (e.key === 'site_home_config') {
        applyHomeModuleConfig();
      }
    });

    // 首页头部横幅（Hero）配置应用与监听
    function applyHeroConfig() {
      function apply(cfg){ cfg = cfg||{};
      const hero = document.getElementById('home-hero');
      const titleEl = document.getElementById('home-hero-title');
      const subEl = document.getElementById('home-hero-subtitle');
      const btn1 = document.getElementById('home-hero-btn1');
      const btn2 = document.getElementById('home-hero-btn2');

      if (hero && cfg.background) hero.style.background = cfg.background;
      if (titleEl && cfg.title) titleEl.textContent = cfg.title;
      if (subEl && cfg.subtitle) subEl.textContent = cfg.subtitle;
      if (btn1) {
        const span1 = btn1.querySelector('span');
        if (cfg.btn1Text && span1) span1.textContent = cfg.btn1Text;
        if (cfg.btn1Href) btn1.href = cfg.btn1Href;
      }
      if (btn2) {
        const span2 = btn2.querySelector('span');
        if (cfg.btn2Text && span2) span2.textContent = cfg.btn2Text;
        if (cfg.btn2Href) btn2.href = cfg.btn2Href;
      }
      }
      if (window.APP_API && window.APP_API.base) {
        window.APP_API.get('home_hero_config').then(function(cfg){ apply(cfg); });
      } else {
        const cfg = JSON.parse(localStorage.getItem('home_hero_config') || '{}');
        apply(cfg);
      }
    }

    function initHeroListener() {
      window.addEventListener('storage', function(e) {
        if (e.key === 'home_hero_config') applyHeroConfig();
      });
      setInterval(applyHeroConfig, 1000);
    }

    // 首页行业快讯渲染（从 localStorage: home_news 读取）
    function applyNewsConfig() {
      const container = document.getElementById('home-news-grid');
      if (!container) return;
      function render(data){
        if (!Array.isArray(data) || data.length === 0) return;
        container.innerHTML = '';
        data.slice(0, 4).forEach(item => {
          const a = document.createElement('a');
          a.href = item.href || 'news.html';
          a.className = 'card card--news bg-white rounded-lg overflow-hidden shadow-sm card-hover block';
          const image = document.createElement('div');
          image.className = 'card__image h-16 bg-gray-100 flex items-center justify-center';
          image.innerHTML = item.cover ? '<img src="'+(item.cover)+'" alt="'+(item.title || '')+'" class="w-full h-full object-cover">' : '<i class="fas fa-newspaper text-gray-400 text-2xl"></i>';
          const content = document.createElement('div');
          content.className = 'card__content p-3';
          const h3 = document.createElement('h3');
          h3.className = 'card__title font-bold text-sm mb-1 line-clamp-2';
          h3.textContent = item.title || '未命名文章';
          const p = document.createElement('p');
          p.className = 'card__description text-gray-600 text-xs line-clamp-2';
          p.textContent = item.summary || '';
          content.appendChild(h3);
          content.appendChild(p);
          a.appendChild(image);
          a.appendChild(content);
          container.appendChild(a);
        });
      }
      if (window.APP_API && window.APP_API.base) {
        window.APP_API.get('home_news').then(function(arr){ render(arr||[]); });
      } else {
        const data = JSON.parse(localStorage.getItem('home_news') || '[]');
        render(data);
      }
    }

    function initNewsListener() {
      window.addEventListener('storage', function(e) {
        if (e.key === 'home_news') applyNewsConfig();
      });
      setInterval(applyNewsConfig, 1000);
    }

    async function syncNewsFromJson(){
      try {
        const r = await fetch('data/news/blog.json');
        let arr = await r.json();
        function getBlogSrcFromHref(href){
          try { const u = new URL(href, location.origin); return decodeURIComponent(u.searchParams.get('src') || ''); } catch { return ''; }
        }
        async function resolveCoverFromItem(item){
          if (item.cover) return item.cover;
          const srcPath = getBlogSrcFromHref(item.href || '');
          if (!srcPath) return '';
          try {
            const rr = await fetch(srcPath);
            const html = await rr.text();
            const doc = new DOMParser().parseFromString(html, 'text/html');
            const main = doc.querySelector('main') || doc.querySelector('article') || doc.body;
            const img = main ? main.querySelector('img') : null;
            let s = img ? (img.getAttribute('src') || '') : '';
            if (!s) return '';
            try { s = new URL(s, srcPath).href; } catch {}
            return s;
          } catch { return ''; }
        }
        arr = await Promise.all(arr.map(async it => { const cover = await resolveCoverFromItem(it); if (cover) it.cover = cover; return it; }));
        const base = JSON.parse(localStorage.getItem('home_news') || '[]');
        const other = base.filter(it => !(String(it.id||'').startsWith('blog-')));
        const merged = other.concat(arr);
        localStorage.setItem('home_news', JSON.stringify(merged));
        localStorage.setItem('news_blog_synced', String(Date.now()));
      } catch {}
    }

    // 首页运价播报渲染（从 localStorage: freight_marquee 读取）
    function applyFreightMarquee() {
      const el = document.getElementById('freight-marquee-text');
      if (!el) return;
      if (window.APP_API && window.APP_API.base) {
        window.APP_API.get('freight_marquee').then(function(v){ var txt = String(v||'').trim(); el.textContent = txt || '热门航线更新：亚洲→北美、欧洲→东南亚、跨太平洋多港直航，实时行情波动，立即查询最新运价！'; });
      } else {
        const txt = (localStorage.getItem('freight_marquee') || '').trim();
        el.textContent = txt || '热门航线更新：亚洲→北美、欧洲→东南亚、跨太平洋多港直航，实时行情波动，立即查询最新运价！';
      }
    }
    function initFreightMarqueeListener() {
      window.addEventListener('storage', function(e) {
        if (e.key === 'freight_marquee') applyFreightMarquee();
      });
      setInterval(applyFreightMarquee, 1000);
    }

    // 获取船东目标页面链接（优先使用完整配置链接，其次从模板推断页面，最后静态首页兜底）
    function getShipownerTargetUrl(code) {
      if (!code || code === 'all') return '';
      const norm = (code || '').toLowerCase().replace(/\s+/g, '');

      // 1) 优先使用首页船东卡片维护中的完整链接（到指定页面）
      try {
        const cards = JSON.parse(localStorage.getItem('home_shipowners_cards') || '[]');
        const card = cards.find(c => (c.name || '').toLowerCase().replace(/\s+/g, '') === norm);
        if (card && card.link) return card.link; // 保留完整路径，跳转到指定页面
      } catch {}

      // 2) 旧 shipowners 的 trackingUrlTemplate，去掉 {query} 占位符以获得指定页面
      try {
        const owners = JSON.parse(localStorage.getItem('shipowners') || '[]');
        const owner = owners.find(o => (o.code || '').toLowerCase().replace(/\s+/g, '') === norm);
        if (owner && owner.trackingUrlTemplate) {
          const tpl = owner.trackingUrlTemplate;
          // 将 {query} 清空，保留到具体页面路径
          return tpl.replace('{query}', '').replace(/\?(&)?$/, '');
        }
      } catch {}

      // 3) 静态映射兜底（常见船东首页）
      const HOMEPAGES = {
        msc: 'https://www.msc.com',
        maersk: 'https://www.maersk.com',
        cma: 'https://www.cma-cgm.com',
        cosco: 'https://lines.coscoshipping.com',
        hapag: 'https://www.hapag-lloyd.com',
        one: 'https://www.one-line.com',
        evergreen: 'https://www.evergreen-marine.com',
        hmm: 'https://www.hmm21.com',
        zim: 'https://www.zim.com',
        yangming: 'https://www.yangming.com',
        oocl: 'https://www.oocl.com',
        pil: 'https://www.pilship.com',
        wanhai: 'https://www.wanhai.com',
        kmtc: 'https://www.kmtc.co.kr',
        sitc: 'https://www.sitc.com',
        tslines: 'https://www.tslines.com',
        rcl: 'https://www.rclgroup.com',
        smline: 'https://www.smline.com',
        ckline: 'https://www.ckline.co.kr',
        namsung: 'https://www.namsung.co.kr'
      };
      return HOMEPAGES[norm] || '';
    }

    // 生成船东卡片的可点击链接
    function generateShipownerCardLinks() {
      const cards = document.querySelectorAll('.shipowners-section .card--shipowner');
      if (!cards || cards.length === 0) return;
      cards.forEach(card => {
        // 从标题获取中文名，并尝试匹配下拉选项确定 code
        const titleEl = card.querySelector('.card__title');
        const nameCn = (titleEl?.textContent || '').trim();
        let code = '';
        const select = document.querySelector('.tracking-section .form__select');
        if (select) {
          const options = Array.from(select.options || []);
          const hit = options.find(opt => (opt.textContent || '').includes(nameCn) || (opt.value || '').toLowerCase().includes(nameCn.toLowerCase()));
          code = hit ? (hit.value || '') : '';
        }
        // 如果无法通过下拉匹配，则尝试从占位Logo旁文字获取（如 MSC、Maersk 等）
        if (!code) {
          const fallbackText = card.querySelector('.card__image div')?.textContent || '';
          code = fallbackText ? fallbackText.toLowerCase() : '';
        }

        const target = getShipownerTargetUrl(code);
        if (target) {
          // 让卡片具备相对定位，以便覆盖整卡的链接层
          if (!card.classList.contains('relative')) card.classList.add('relative');
          const a = document.createElement('a');
          a.href = target;
          a.target = '_self';
          a.setAttribute('aria-label', `前往${nameCn}官网`);
          a.style.position = 'absolute';
          a.style.top = '0';
          a.style.left = '0';
          a.style.right = '0';
          a.style.bottom = '0';
          a.style.zIndex = '10';
          // 防止重复添加
          const exists = card.querySelector('a[aria-label^="前往"]');
          if (!exists) card.appendChild(a);
          // 鼠标形状提示可点击
          card.style.cursor = 'pointer';
        }
      });
    }

    // 初始化按钮事件
    function initButtonEvents() {
      // 查询按钮事件（带校验与跳转规则）
      const trackingForm = document.querySelector('.tracking-section__form');
      const searchBtn = trackingForm?.querySelector('.btn-primary');
      const input = trackingForm?.querySelector('.form__input');
      const select = trackingForm?.querySelector('.form__select');
      const helpLink = document.querySelector('.tracking-section__help .link');

      const trackingSettings = JSON.parse(localStorage.getItem('trackingSettings') || '{}');

      // 应用帮助链接文本和 href（申请加入船东）
      if (helpLink) {
        if (trackingSettings.linkText) helpLink.textContent = trackingSettings.linkText;
        if (trackingSettings.helpLinkHref) helpLink.href = trackingSettings.helpLinkHref;
        helpLink.addEventListener('click', (e) => {
          if (!helpLink.href || helpLink.href === '#') {
            e.preventDefault();
            alert('如果没有找到需要的船东，请通过联系我们页面留言或发送邮件至 support@yxtrans.com，我们会尽快处理您的申请。');
          }
        });
      }

      if (searchBtn && select) {
        searchBtn.addEventListener('click', (e) => {
          e.preventDefault();
          const shipownerCode = select?.value || 'all';
          if (!shipownerCode || shipownerCode === 'all') {
            alert('请先在下拉菜单中选择具体船东');
            return;
          }

          // 新跳转规则：直接前往所选船东的指定页面（若有配置），否则兜底到班轮表页面
          const target = getShipownerTargetUrl(shipownerCode);
          const fallback = `pages/schedules/index.html?owner=${encodeURIComponent(shipownerCode)}`; // 兜底到班轮表页面
          window.location.href = target || fallback;
        });
      }

      // 快速工具按钮事件（仅对占位按钮生效，避免影响真实提交按钮）
      const toolButtons = document.querySelectorAll('.sidebar__card button[data-placeholder="true"]');
      toolButtons.forEach(btn => {
        btn.addEventListener('click', function(e) {
          const spanEl = this.querySelector('span');
          const toolName = spanEl ? (spanEl.textContent || '该工具') : '该工具';
          alert(`${toolName}功能正在开发中，敬请期待！`);
          e.preventDefault();
        });
      });
    }

    // 应用集装箱追踪设置
    function applyTrackingSettings(settings) {
      try {
        console.log('开始应用集装箱追踪设置:', settings);
        
        // 更新标题
        if (settings.title) {
          const titleElement = document.querySelector('.tracking-section h2');
          console.log('标题元素:', titleElement);
          if (titleElement) {
            titleElement.textContent = settings.title;
            console.log('标题已更新为:', settings.title);
          } else {
            console.warn('未找到标题元素');
          }
        }

        // 更新占位符
        if (settings.placeholder) {
          const inputElement = document.querySelector('.tracking-section input[type="text"]');
          console.log('输入框元素:', inputElement);
          if (inputElement) {
            inputElement.placeholder = settings.placeholder;
            console.log('占位符已更新为:', settings.placeholder);
          } else {
            console.warn('未找到输入框元素');
          }
        }

        // 更新按钮文字
        if (settings.buttonText) {
          const buttonElement = document.querySelector('.tracking-section button span');
          console.log('按钮元素:', buttonElement);
          if (buttonElement) {
            buttonElement.textContent = settings.buttonText;
            console.log('按钮文字已更新为:', settings.buttonText);
          } else {
            console.warn('未找到按钮文字元素');
          }
        }

        // 更新申请链接文字与链接
        const linkElement = document.querySelector('.tracking-section__help a');
        if (settings.linkText && linkElement) {
          linkElement.textContent = settings.linkText;
          console.log('链接文字已更新为:', settings.linkText);
        }
        if (settings.helpLinkHref && linkElement) {
          linkElement.href = settings.helpLinkHref;
          console.log('申请链接已更新为:', settings.helpLinkHref);
        }

        console.log('集装箱追踪设置应用完成');
      } catch (error) {
        console.error('应用集装箱追踪设置失败:', error);
      }
    }

    // 监听localStorage变化
    function initTrackingSettingsListener() {
      // 页面加载时检查是否有保存的设置
      if (window.APP_API && window.APP_API.base) {
        window.APP_API.get('trackingSettings').then(function(settings){ if (settings) applyTrackingSettings(settings); });
      } else {
        const savedSettings = localStorage.getItem('trackingSettings');
        if (savedSettings) {
          try { const settings = JSON.parse(savedSettings); applyTrackingSettings(settings); } catch (error) { console.error('解析保存的集装箱追踪设置失败:', error); }
        }
      }

      // 监听storage事件（跨标签页通信）
      window.addEventListener('storage', function(e) {
        if (e.key === 'trackingSettings' && e.newValue) {
          try {
            const settings = JSON.parse(e.newValue);
            applyTrackingSettings(settings);
          } catch (error) {
            console.error('解析集装箱追踪设置失败:', error);
          }
        }
      });

      // 定期检查设置更新（同标签页内通信）
      let lastUpdateTime = localStorage.getItem('trackingSettingsUpdated') || '0';
      setInterval(() => {
        const currentUpdateTime = localStorage.getItem('trackingSettingsUpdated') || '0';
        if (currentUpdateTime !== lastUpdateTime) {
          lastUpdateTime = currentUpdateTime;
          const savedSettings = localStorage.getItem('trackingSettings');
          if (savedSettings) {
            try {
              const settings = JSON.parse(savedSettings);
              applyTrackingSettings(settings);
            } catch (error) {
              console.error('解析集装箱追踪设置失败:', error);
            }
          }
        }
      }, 1000); // 每秒检查一次
    }

    // 船东数据同步功能
    function loadShipownersFromStorage() {
      console.log('开始加载船东数据...');
      
      // 默认船东数据（与管理后台保持一致）
      const defaultShipowners = [
        { code: 'all', name: '所有船东' },
        { code: 'msc', name: '地中海航运(MSC)' },
        { code: 'maersk', name: '马士基(Maersk)' },
        { code: 'cma', name: '达飞轮船(CMA CGM)' },
        { code: 'cosco', name: '中远海运(COSCO Shipping)' },
        { code: 'hapag', name: '赫伯罗特(Hapag-Lloyd)' },
        { code: 'one', name: '海洋网联(ONE)' },
        { code: 'evergreen', name: '长荣海运(Evergreen)' },
        { code: 'hmm', name: '现代商船(HMM)' },
        { code: 'zim', name: '以星航运(ZIM)' },
        { code: 'yangming', name: '阳明海运(Yang Ming)' },
        { code: 'oocl', name: '东方海外(OOCL)' },
        { code: 'pil', name: '太平船务(PIL)' },
        { code: 'wanhai', name: '万海航运(Wan Hai)' },
        { code: 'kmtc', name: '高丽海运(KMTC)' },
        { code: 'sitc', name: '海丰国际(SITC)' },
        { code: 'tslines', name: '德翔海运(TS Lines)' },
        { code: 'rcl', name: '宏海船务(RCL)' },
        { code: 'smline', name: '长锦商船(SM Line)' },
        { code: 'ckline', name: '天敬海运(CK Line)' },
        { code: 'namsung', name: '南星船务(NAMSUNG)' }
      ];

      try {
        // 优先采用“首页船东卡片维护”数据作为下拉来源，其次回退到旧的 shipowners
        const homeCardsRaw = localStorage.getItem('home_shipowners_cards');
        const savedShipowners = localStorage.getItem('shipowners');
        let shipowners = [];

        if (homeCardsRaw) {
          const cards = JSON.parse(homeCardsRaw || '[]');
          if (Array.isArray(cards) && cards.length > 0) {
            console.log('使用 home_shipowners_cards 作为下拉数据源:', cards);
            shipowners = [{ code: 'all', name: '所有船东' }];
            cards.forEach(card => {
              const code = (card.name || '').toLowerCase().replace(/\s+/g, '');
              shipowners.push({ code, name: card.name, link: card.link || '' });
            });
          }
        }

        if (shipowners.length === 0 && savedShipowners) {
          const parsedShipowners = JSON.parse(savedShipowners);
          console.log('回退到旧 shipowners 数据源:', parsedShipowners);
          // 添加"所有船东"选项
          shipowners = [{ code: 'all', name: '所有船东' }];
          parsedShipowners.forEach(shipowner => {
            shipowners.push({
              code: (shipowner.code || '').toLowerCase().replace(/\s+/g, ''),
              name: shipowner.name,
              link: shipowner.link || ''
            });
          });
        }

        if (shipowners.length === 0) {
          console.log('localStorage中没有船东数据，使用默认数据');
          shipowners = defaultShipowners;
        }

        // 更新船东下拉菜单
        const select = document.querySelector('.form__select');
        if (select) {
          select.innerHTML = '';
          
          shipowners.forEach(shipowner => {
            const option = document.createElement('option');
            option.value = shipowner.code;
            option.textContent = shipowner.name;
            select.appendChild(option);
          });
          
          console.log(`船东下拉菜单已更新，共${shipowners.length}个选项`);
        } else {
          console.error('未找到船东下拉菜单元素');
        }
      } catch (error) {
        console.error('加载船东数据失败:', error);
        // 出错时使用默认数据
        const select = document.querySelector('.form__select');
        if (select) {
          select.innerHTML = '';
          defaultShipowners.forEach(shipowner => {
            const option = document.createElement('option');
            option.value = shipowner.code;
            option.textContent = shipowner.name;
            select.appendChild(option);
          });
        }
      }
    }

    // 监听船东数据变化
    function initShipownersListener() {
      // 监听localStorage变化（跨标签页通信）
      window.addEventListener('storage', function(e) {
        if (e.key === 'shipowners' || e.key === 'shipownersUpdated' || e.key === 'home_shipowners_cards') {
          console.log('检测到船东数据变化，重新加载...');
          loadShipownersFromStorage();
        }
      });

      // 定期检查船东数据更新（同标签页内通信）
      let lastShipownersUpdateTime = localStorage.getItem('shipownersUpdated') || '0';
      setInterval(() => {
        const currentUpdateTime = localStorage.getItem('shipownersUpdated') || '0';
        if (currentUpdateTime !== lastShipownersUpdateTime) {
          lastShipownersUpdateTime = currentUpdateTime;
          console.log('检测到船东数据更新，重新加载...');
          loadShipownersFromStorage();
        }
        // 轮询首页船东卡片维护数据
        const homeCardsRaw = localStorage.getItem('home_shipowners_cards') || '';
        if (homeCardsRaw !== (window.__lastHomeOwnersRaw || '')) {
          window.__lastHomeOwnersRaw = homeCardsRaw;
          console.log('检测到 home_shipowners_cards 变化，重新加载...');
          loadShipownersFromStorage();
        }
      }, 1000); // 每秒检查一次
    }

    // 在页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', function() {
      initTrackingSettingsListener();
      loadShipownersFromStorage(); // 初始加载船东数据
      initShipownersListener(); // 初始化船东数据监听
      generateShipownerCardLinks(); // 生成船东列表卡片的点击跳转链接
    });
  </script>

  <!-- 页脚容器 -->
  <div id="footer-container"></div>
</body>
</html>
